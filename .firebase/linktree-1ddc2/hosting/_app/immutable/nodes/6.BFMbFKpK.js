import{s as F,k as j,p as q,i as g,f as h,e as k,a as E,c as v,b as T,g as U,o as b,u as A,h as _,v as B,q as N,w as M,x as W,t as C,d as w,m as S,j as I}from"../chunks/scheduler.BqWbeFoV.js";import{S as Z,i as G,c as H,a as J,m as K,t as Q,b as X,d as $}from"../chunks/index.DRmShFnm.js";import{A as x}from"../chunks/AuthCheck.CtSQ_tQv.js";import{a as ee,u as te,h as R,i as D,j as se,w as le}from"../chunks/firebase.CPclXUWJ.js";function ne(a){let e,s,n,t,l,o,d,u,y,m=a[1]&&L(a),f=!a[3]&&a[5]&&O(),p=a[3]&&!a[2]&&!a[1]&&V(a),r=a[3]&&!a[4]&&!a[1]&&Y(a);return{c(){e=k("form"),s=k("input"),n=E(),t=k("div"),m&&m.c(),l=E(),f&&f.c(),o=E(),p&&p.c(),d=E(),r&&r.c(),this.h()},l(i){e=v(i,"FORM",{class:!0});var c=T(e);s=v(c,"INPUT",{type:!0,placeholder:!0,class:!0}),n=U(c),t=v(c,"DIV",{class:!0});var P=T(t);m&&m.l(P),l=U(P),f&&f.l(P),o=U(P),p&&p.l(P),d=U(P),r&&r.l(P),P.forEach(h),c.forEach(h),this.h()},h(){b(s,"type","text"),b(s,"placeholder","username"),b(s,"class","input w-full"),A(s,"input-error",!a[3]&&a[5]),A(s,"input-warning",a[4]),A(s,"input-success",a[2]&&a[3]&&!a[1]),b(t,"class","my-4 min-h-16 px-8 w-full"),b(e,"class","w-2/5")},m(i,c){g(i,e,c),_(e,s),B(s,a[0]),_(e,n),_(e,t),m&&m.m(t,null),_(t,l),f&&f.m(t,null),_(t,o),p&&p.m(t,null),_(t,d),r&&r.m(t,null),u||(y=[N(s,"input",a[9]),N(s,"input",a[7]),N(e,"submit",M(a[8]))],u=!0)},p(i,c){c&1&&s.value!==i[0]&&B(s,i[0]),c&40&&A(s,"input-error",!i[3]&&i[5]),c&16&&A(s,"input-warning",i[4]),c&14&&A(s,"input-success",i[2]&&i[3]&&!i[1]),i[1]?m?m.p(i,c):(m=L(i),m.c(),m.m(t,l)):m&&(m.d(1),m=null),!i[3]&&i[5]?f||(f=O(),f.c(),f.m(t,o)):f&&(f.d(1),f=null),i[3]&&!i[2]&&!i[1]?p?p.p(i,c):(p=V(i),p.c(),p.m(t,d)):p&&(p.d(1),p=null),i[3]&&!i[4]&&!i[1]?r?r.p(i,c):(r=Y(i),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(i){i&&h(e),m&&m.d(),f&&f.d(),p&&p.d(),r&&r.d(),u=!1,W(y)}}}function ae(a){let e,s,n,t,l=a[6].username+"",o,d,u,y="(Usernames cannot be changed)",m,f,p="Upload Profile Image";return{c(){e=k("p"),s=C("Your username is "),n=k("span"),t=C("@"),o=C(l),d=E(),u=k("p"),u.textContent=y,m=E(),f=k("a"),f.textContent=p,this.h()},l(r){e=v(r,"P",{class:!0});var i=T(e);s=w(i,"Your username is "),n=v(i,"SPAN",{class:!0});var c=T(n);t=w(c,"@"),o=w(c,l),c.forEach(h),i.forEach(h),d=U(r),u=v(r,"P",{class:!0,"data-svelte-h":!0}),S(u)!=="svelte-9l80or"&&(u.textContent=y),m=U(r),f=v(r,"A",{class:!0,href:!0,"data-svelte-h":!0}),S(f)!=="svelte-vogdig"&&(f.textContent=p),this.h()},h(){b(n,"class","text-success font-bold"),b(e,"class","text-lg"),b(u,"class","text-sm"),b(f,"class","btn btn-primary"),b(f,"href","/login/photo")},m(r,i){g(r,e,i),_(e,s),_(e,n),_(n,t),_(n,o),g(r,d,i),g(r,u,i),g(r,m,i),g(r,f,i)},p(r,i){i&64&&l!==(l=r[6].username+"")&&I(o,l)},d(r){r&&(h(e),h(d),h(u),h(m),h(f))}}}function L(a){let e,s,n,t;return{c(){e=k("p"),s=C("Checking availability of @"),n=C(a[0]),t=C("..."),this.h()},l(l){e=v(l,"P",{class:!0});var o=T(e);s=w(o,"Checking availability of @"),n=w(o,a[0]),t=w(o,"..."),o.forEach(h),this.h()},h(){b(e,"class","text-secondary")},m(l,o){g(l,e,o),_(e,s),_(e,n),_(e,t)},p(l,o){o&1&&I(n,l[0])},d(l){l&&h(e)}}}function O(a){let e,s="must be 3-16 characters long, alphanumeric only";return{c(){e=k("p"),e.textContent=s,this.h()},l(n){e=v(n,"P",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1gie62t"&&(e.textContent=s),this.h()},h(){b(e,"class","text-error text-sm")},m(n,t){g(n,e,t)},d(n){n&&h(e)}}}function V(a){let e,s,n,t;return{c(){e=k("p"),s=C("@"),n=C(a[0]),t=C(" is not available"),this.h()},l(l){e=v(l,"P",{class:!0});var o=T(e);s=w(o,"@"),n=w(o,a[0]),t=w(o," is not available"),o.forEach(h),this.h()},h(){b(e,"class","text-warning text-sm")},m(l,o){g(l,e,o),_(e,s),_(e,n),_(e,t)},p(l,o){o&1&&I(n,l[0])},d(l){l&&h(e)}}}function Y(a){let e,s,n;return{c(){e=k("button"),s=C("Confirm username @"),n=C(a[0]),this.h()},l(t){e=v(t,"BUTTON",{class:!0});var l=T(e);s=w(l,"Confirm username @"),n=w(l,a[0]),l.forEach(h),this.h()},h(){b(e,"class","btn btn-success")},m(t,l){g(t,e,l),_(e,s),_(e,n)},p(t,l){l&1&&I(n,t[0])},d(t){t&&h(e)}}}function ie(a){let e;function s(l,o){var d;return(d=l[6])!=null&&d.username?ae:ne}let n=s(a),t=n(a);return{c(){t.c(),e=q()},l(l){t.l(l),e=q()},m(l,o){t.m(l,o),g(l,e,o)},p(l,o){n===(n=s(l))&&t?t.p(l,o):(t.d(1),t=n(l),t&&(t.c(),t.m(e.parentNode,e)))},d(l){l&&h(e),t.d(l)}}}function oe(a){let e,s;return e=new x({props:{$$slots:{default:[ie]},$$scope:{ctx:a}}}),{c(){H(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,t){K(e,n,t),s=!0},p(n,[t]){const l={};t&4223&&(l.$$scope={dirty:t,ctx:n}),e.$set(l)},i(n){s||(Q(e.$$.fragment,n),s=!0)},o(n){X(e.$$.fragment,n),s=!1},d(n){$(e,n)}}}const re=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function ue(a,e,s){let n,t,l,o,d;j(a,ee,c=>s(11,o=c)),j(a,te,c=>s(6,d=c));let u="",y=!1,m=!1,f;async function p(){s(2,m=!1),clearTimeout(f),s(1,y=!0),f=setTimeout(async()=>{console.log("Checking username",u);const c=R(D,"usernames",u),P=await se(c).then(z=>z.exists());s(2,m=!P),s(1,y=!1)},500)}async function r(){console.log("confirming username",u);const c=le(D);c.set(R(D,"usernames",u),{uid:o==null?void 0:o.uid}),c.set(R(D,"users",o.uid),{username:u,photoURL:(o==null?void 0:o.photoURL)??null,published:!0,bio:"I am Walus",links:[{title:"Twitter",url:"https://twitter.com/walus",icon:"custom"}]}),await c.commit(),s(0,u=""),s(2,m=!1)}function i(){u=this.value,s(0,u)}return a.$$.update=()=>{a.$$.dirty&1&&s(3,n=(u==null?void 0:u.length)>2&&u.length<16&&re.test(u)),a.$$.dirty&1&&s(5,t=u.length>0),a.$$.dirty&14&&s(4,l=n&&!m&&!y)},[u,y,m,n,l,t,d,p,r,i]}class he extends Z{constructor(e){super(),G(this,e,ue,oe,F,{})}}export{he as component};
